<h1>Futuralkarnevalens internweb</h1>

<p><i>
  Du är inloggad som <%= current_user.email %>.
  <%= sign_out_link 'Logga ut?' %>
</i></p>

<br>

<% unless current_user.roles.empty? %>
  <p><b>Du är 
    <%= spell_out_list current_user.roles.map(&:name).uniq %>.
  </b></p>
<% end %>

<h2>Du har följande superkrafter:</h2>

<ul>
  <%# Stuff relating to the current karnevalist %>
  <% if can? :read, current_user.karnevalist %>
    <li><%= link_to 'Se din registrering', current_user.karnevalist %></li>
  <% end %>

  <%# General stuff %>
  <% if can? :read, Notification %>
    <li><%= link_to 'Läsa gamla pushnotiser', Notification %>
  <% end %>

  <%# Sektionsadmin stuff %>
  <% if current_user.is? :sektionsadmin and current_user.karnevalist? %>
    <% s = current_user.karnevalist.sektion %>
    <% if can? :read, s %>
      <li><%= link_to 'Se vilka som är med i din sektion', s %>
    <% end %>
  <% end %>

  <%# Admin stuff %>
  <% if current_user.is? :admin %>
    <% if can? :read, Karnevalist %>
      <li><%= link_to 'Söka upp karnevalister i registret', Karnevalist %>
    <% end %>
    <% if can? :read, Sektion %>
      <li><%= link_to 'Se listan med alla sektioner', Sektion %>
    <% end %>
    <% if can? :create, Notification %>
      <li><%= link_to 'Skicka ut pushnotiser', new_notification_path %>
    <% end %>
  <% end %>
</ul>
  
